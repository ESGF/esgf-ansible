
- name: Install libselinux-python
  package:
    name: libselinux-python

- name: Disable SELinux
  selinux:
    state: disabled
  register: selinux_result

- name: Reboot {{ ansible_fqdn }} using a 15 minute timeout
  when: selinux_result.reboot_required
  reboot:
    reboot_timeout: 900 # 15 minutes
  register: reboot_result

- debug:
    msg: "{{ ansible_fqdn }} rebooted in {{ reboot_result.elapsed }} seconds"
  when: selinux_result.reboot_required
